<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>test3 | Nangman's Research Lab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #6c77dd;
      --secondary-color: #7895cb;
      --accent-color: #a0bfe0;
      --light-color: #c5dff8;
      --dark-color: #121620;
      --dark-color-alt: #162032;
      --text-color: #e0e6f0;
      --text-light: #a0aabf;
      --bg-color: #0f1319;
      --bg-gradient: linear-gradient(135deg, #0f1319 0%, #16202f 100%);
      --card-bg: #1a212e;
      --card-bg-gradient: linear-gradient(135deg, #191f2a 0%, #1e2534 100%);
      --post-content-bg: linear-gradient(135deg, #1e2435 0%, #212b3d 100%);
      --header-bg: rgba(15, 19, 25, 0.95);
      --border-color: #2a3548;
      --shadow-color: rgba(0, 0, 0, 0.4);
      --hover-color: #232e42;
      --header-height: 70px;
      --sidebar-width: 320px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans KR', sans-serif;
      color: var(--text-color);
      background: var(--bg-gradient);
      line-height: 1.6;
    }

    a {
      color: var(--accent-color);
      text-decoration: none;
      transition: color 0.3s;
    }

    a:hover {
      color: var(--light-color);
    }

    /* 헤더 및 네비게이션 */
    .site-header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: linear-gradient(to right, rgba(15, 19, 25, 0.95), rgba(20, 30, 45, 0.95));
      box-shadow: 0 2px 10px var(--shadow-color);
      z-index: 1000;
      height: var(--header-height);
      display: flex;
      align-items: center;
      padding: 0 2rem;
      transition: all 0.3s ease-in-out;
    }

    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-color);
    }

    .nav-menu {
      margin-left: auto;
      display: flex;
      list-style: none;
    }

    .nav-menu li {
      margin-left: 1.5rem;
    }

    .nav-menu a {
      color: var(--text-color);
      font-weight: 500;
      position: relative;
    }

    .nav-menu a::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 0;
      height: 2px;
      background-color: var(--primary-color);
      transition: width 0.3s;
    }

    .nav-menu a:hover::after {
      width: 100%;
    }

    .mobile-menu-btn {
      display: none;
      cursor: pointer;
      margin-left: auto;
    }

    .mobile-menu-btn span {
      display: block;
      width: 25px;
      height: 3px;
      margin: 5px 0;
      background-color: var(--primary-color);
      transition: all 0.3s;
    }

    /* 메인 컨테이너 - 그리드 레이아웃 */
    .main-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: calc(var(--header-height) + 2rem) 2rem 3rem;
      display: grid;
      grid-template-columns: minmax(0, 1fr) var(--sidebar-width);
      gap: 2rem;
    }

    /* 포스트 스타일 */
    .post-container {
      width: 100%;
    }

    .post {
      background: var(--card-bg-gradient);
      border-radius: 16px;
      box-shadow: 0 8px 30px var(--shadow-color);
      overflow: hidden;
      border: 1px solid var(--border-color);
    }

    .post-header {
      padding: 0 0 1.5rem;
      border-bottom: 1px solid rgba(160, 190, 224, 0.1);
    }

    .post-thumbnail {
      width: 100%;
      height: 300px;
      overflow: hidden;
      margin-bottom: 2rem;
    }

    .post-feature-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s;
    }

    .post-title {
      font-size: 2.4rem;
      font-weight: 700;
      color: var(--text-color);
      margin: 0 3rem 1rem;
      line-height: 1.3;
    }

    .post-meta {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      margin: 0 3rem;
      font-size: 0.95rem;
      color: var(--text-light);
    }

    .meta-sep {
      margin: 0 0.5rem;
      color: var(--accent-color);
    }

    .post-date {
      font-weight: 500;
    }

    .post-categories a, .post-tags a {
      color: var(--accent-color);
      transition: color 0.3s;
    }

    .post-categories a:hover, .post-tags a:hover {
      color: var(--primary-color);
    }

    .post-content {
      padding: 2.5rem 3.5rem;
      font-size: 1.1rem;
      line-height: 1.8;
      color: var(--text-color);
      background: var(--post-content-bg);
      border-radius: 8px;
      margin: 1.5rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(160, 190, 224, 0.15);
    }

    .post-content h1 {
      font-size: 2.2rem;
      margin: 3rem 0 1.5rem;
      color: var(--text-color);
      border-bottom: 3px solid var(--border-color);
      padding-bottom: 0.7rem;
      scroll-margin-top: 80px;
    }

    .post-content h2 {
      font-size: 1.8rem;
      margin: 2.5rem 0 1.2rem;
      color: var(--text-color);
      border-bottom: 2px solid var(--border-color);
      padding-bottom: 0.5rem;
      scroll-margin-top: 80px;
    }

    .post-content h3 {
      font-size: 1.5rem;
      margin: 2rem 0 1rem;
      color: var(--text-color);
      scroll-margin-top: 80px;
    }

    .post-content h4 {
      font-size: 1.2rem;
      margin: 1.5rem 0 0.5rem;
      color: var(--text-color);
      scroll-margin-top: 80px;
    }

    .post-content p {
      margin-bottom: 1.5rem;
    }

    .post-content img {
      max-width: 100%;
      border-radius: 8px;
      margin: 1.5rem 0;
      box-shadow: 0 5px 15px var(--shadow-color);
    }

    .post-content blockquote {
      border-left: 4px solid var(--primary-color);
      padding: 1rem 1.5rem;
      margin: 1.5rem 0;
      background: linear-gradient(90deg, rgba(108, 119, 221, 0.1), transparent);
      font-style: italic;
      color: var(--text-light);
      border-radius: 0 8px 8px 0;
    }

    .post-content ul, .post-content ol {
      margin: 1.5rem 0 1.5rem 2rem;
    }

    .post-content li {
      margin-bottom: 0.8rem;
    }

    .post-content a {
      color: var(--primary-color);
      font-weight: 500;
      text-decoration: underline;
      text-decoration-color: transparent;
      transition: text-decoration-color 0.3s;
    }

    .post-content a:hover {
      text-decoration-color: var(--primary-color);
    }

    /* 코드 스타일 */
    .post-content pre {
      background: var(--dark-color-alt);
      border-radius: 8px;
      padding: 1.2rem;
      overflow-x: auto;
      margin: 1.5rem 0;
      border: 1px solid var(--border-color);
    }

    .post-content code {
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      color: var(--light-color);
    }

    .post-content p code {
      background: var(--dark-color-alt);
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    /* 사이드바 목차 스타일 */
    .toc-sidebar {
      position: sticky;
      top: calc(var(--header-height) + 2rem);
      height: calc(100vh - var(--header-height) - 4rem);
      overflow-y: auto;
      padding-right: 10px;
      /* 스크롤바 스타일 */
      scrollbar-width: thin;
      scrollbar-color: var(--accent-color) transparent;
      width: var(--sidebar-width);
    }

    .toc-sidebar::-webkit-scrollbar {
      width: 6px;
    }

    .toc-sidebar::-webkit-scrollbar-track {
      background: transparent;
    }

    .toc-sidebar::-webkit-scrollbar-thumb {
      background-color: var(--accent-color);
      border-radius: 6px;
    }

    .toc-container {
      background: var(--dark-color-alt); /* 사이트 컬러와 어울리는 배경색 */
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 8px 30px var(--shadow-color);
      border: 1px solid var(--border-color);
      font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
    }

    .toc-title {
      font-size: 1rem;
      padding: 0.8rem 1rem;
      background: var(--dark-color); /* 헤더 배경색 조정 */
      color: var(--text-color);
      font-weight: 500;
      display: flex;
      align-items: center;
      margin: 0;
      border-bottom: 1px solid var(--border-color);
    }

    .toc-title::before {
      content: "$ ";
      margin-right: 8px;
      color: var(--primary-color); /* 프롬프트 색상 */
    }

    .toc-list {
      list-style: none;
      margin: 0;
      padding: 0.8rem;
      color: var(--text-color); /* 기본 텍스트 색상 */
    }

    .toc-list li {
      margin-bottom: 0;
      padding-left: 0;
      line-height: 1.7;
      font-size: 0.9rem;
    }

    .toc-list a {
      color: inherit;
      display: inline;
      padding: 0;
      transition: color 0.2s;
      text-decoration: none;
      position: relative;
      white-space: normal; /* 줄바꿈 허용 */
      word-break: break-word; /* 단어 중간에서도 줄바꿈 가능하도록 */
      overflow: visible; /* 오버플로우 표시 */
    }

    .toc-list a:hover {
      color: var(--primary-color); /* 호버 색상 변경 */
    }

    .toc-list a.active {
      color: var(--primary-color); /* 활성 항목 색상 */
      font-weight: bold;
    }

    /* 폴더 구조 표시 */
    .toc-list-item {
      position: relative;
      display: block;
      padding-left: 0;
      margin-bottom: 3px;
      white-space: normal; /* 줄바꿈 허용 */
    }

    .toc-list-item::before {
      content: "|- ";
      color: var(--accent-color);
      font-weight: normal;
      white-space: nowrap; /* |- 부분은 줄바꿈 없이 */
      position: absolute;
      left: 0;
    }

    .toc-list > .toc-list-item::before {
      content: "|- ";
    }

    /* 아이콘 제거하고 폴더 표시 스타일 적용 */
    .toc-list .toc-h1::before,
    .toc-list .toc-h2::before,
    .toc-list .toc-h3::before {
      display: none;
    }

    .toc-list-item a {
      padding-left: 22px; /* |- 표시 공간 확보 */
      display: block; /* 링크를 블록 레벨로 변경하여 전체 너비 사용 */
    }

    .toc-list .toc-h1 {
      color: var(--light-color); /* 폴더 색상 */
    }

    .toc-list .toc-h2 {
      color: var(--secondary-color); /* 파일 색상 */
    }

    .toc-list .toc-h3 {
      color: var(--accent-color); /* 속성 색상 */
    }

    .toc-list-item-no-children {
      padding-left: 0;
    }

    .toc-children {
      margin: 0 0 0 18px;
      padding: 0;
      height: auto;
      max-height: 2000px;
      overflow: hidden;
      transition: max-height 0.3s ease-out, opacity 0.2s ease-in-out;
      opacity: 1;
    }

    .toc-children.collapsed {
      max-height: 0;
      opacity: 0;
      margin: 0 0 0 18px;
    }

    /* 목차 아이템 사이 구분선 제거 */
    .toc-list > .toc-list-item {
      border-bottom: none;
      padding-bottom: 0;
    }

    .toc-list > .toc-list-item:last-child {
      border-bottom: none;
    }

    .toc-folder-icon {
      display: none;
    }

    .mobile-toc-toggle {
      display: none;
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--primary-color);
      color: white;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      z-index: 100;
      border: none;
      cursor: pointer;
      align-items: center;
      justify-content: center;
    }

    .mobile-toc-toggle svg {
      width: 24px;
      height: 24px;
    }

    /* 포스트 푸터 */
    .post-footer {
      border-top: 1px solid rgba(160, 190, 224, 0.1);
      padding: 2rem 3rem;
      margin-top: 1rem;
    }

    .post-navigation {
      display: flex;
      justify-content: space-between;
      margin-bottom: 2rem;
    }

    .post-navigation-prev, .post-navigation-next {
      flex: 0 0 48%;
    }

    .post-navigation-next {
      text-align: right;
    }

    .prev-post, .next-post {
      display: block;
      padding: 1rem;
      border-radius: 8px;
      background: linear-gradient(145deg, var(--dark-color) 0%, var(--dark-color-alt) 100%);
      transition: transform 0.3s, box-shadow 0.3s;
      border: 1px solid var(--border-color);
    }

    .prev-post:hover, .next-post:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px var(--shadow-color);
    }

    .nav-label {
      display: block;
      font-size: 0.8rem;
      color: var(--accent-color);
      margin-bottom: 0.3rem;
    }

    .post-navigation .post-title {
      font-size: 1rem;
      font-weight: 500;
      margin: 0;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .related-posts {
      margin-top: 3rem;
      padding-top: 2rem;
      border-top: 1px solid rgba(160, 190, 224, 0.1);
    }

    .related-posts h3 {
      font-size: 1.4rem;
      margin-bottom: 1.5rem;
      color: var(--text-color);
    }

    .related-posts ul {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .related-posts li {
      margin-bottom: 1rem;
    }

    .related-posts a {
      padding: 1rem;
      border-radius: 8px;
      background: linear-gradient(145deg, var(--dark-color) 0%, var(--dark-color-alt) 100%);
      display: block;
      transition: transform 0.3s, box-shadow 0.3s;
      border: 1px solid var(--border-color);
    }

    .related-posts a:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px var(--shadow-color);
    }

    .related-posts h4 {
      margin: 0 0 0.5rem;
      font-size: 1.1rem;
      color: var(--text-color);
    }

    .related-posts time {
      font-size: 0.85rem;
      color: var(--text-light);
    }

    /* 푸터 */
    .site-footer {
      background: linear-gradient(to bottom, var(--dark-color) 0%, #0d121e 100%);
      color: white;
      padding: 1.5rem 0 1rem;
      margin-top: 2rem;
      position: relative;
      border-top: 1px solid var(--border-color);
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .footer-logo {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 0.7rem;
    }

    .copyright {
      text-align: center;
      margin-top: 1rem;
      color: rgba(255, 255, 255, 0.5);
      font-size: 0.75rem;
    }

    /* 반응형 스타일 */
    @media (max-width: 1024px) {
      .main-container {
        grid-template-columns: 1fr;
      }

      :root {
        --sidebar-width: 350px; /* 모바일에서 더 넓게 */
      }

      .toc-sidebar {
        width: var(--sidebar-width);
      }

      .mobile-toc-toggle {
        display: flex;
      }
    }

    @media (max-width: 768px) {
      .site-header {
        padding: 0 1rem;
      }

      .mobile-menu-btn {
        display: block;
      }

      .nav-menu {
        position: fixed;
        top: var(--header-height);
        right: -100%;
        width: 70%;
        height: calc(100vh - var(--header-height));
        background: linear-gradient(135deg, var(--bg-color) 0%, var(--dark-color-alt) 100%);
        flex-direction: column;
        padding: 2rem;
        box-shadow: -5px 0 15px var(--shadow-color);
        transition: right 0.3s ease-in-out;
      }

      .nav-menu.active {
        right: 0;
      }

      .nav-menu li {
        margin: 1rem 0;
      }

      .main-container {
        padding: calc(var(--header-height) + 1.5rem) 1rem 2rem;
      }

      .post-title {
        font-size: 2rem;
        margin: 0 2rem 1rem;
      }
      
      .post-meta {
        margin: 0 2rem;
      }
      
      .post-thumbnail {
        height: 200px;
      }
      
      .post-content {
        padding: 2rem;
        font-size: 1rem;
        margin: 1.5rem 1rem;
      }
      
      .post-footer {
        padding: 1.5rem 2rem;
      }
      
      .post-navigation {
        flex-direction: column;
      }
      
      .post-navigation-prev, .post-navigation-next {
        flex: 0 0 100%;
        margin-bottom: 1rem;
      }
      
      .post-navigation-next {
        text-align: left;
      }
    }

    @media (max-width: 600px) {
      .post-title {
        font-size: 1.8rem;
        margin: 0 1.5rem 1rem;
      }
      
      .post-meta {
        margin: 0 1.5rem;
        font-size: 0.85rem;
      }
      
      .post-thumbnail {
        height: 180px;
      }
      
      .post-content {
        padding: 1.5rem;
        margin: 1rem 0.5rem;
      }
      
      .post-footer {
        padding: 1.5rem;
      }

      .toc-sidebar {
        width: 280px;
        right: 10px;
        bottom: 70px;
      }
    }

    /* CSS 추가 - 제목 스타일 */
    .toc-root-item > a {
      font-weight: 600;
      font-size: 1rem;
      color: var(--primary-color) !important;
      margin-bottom: 10px;
      display: block !important;
      padding-left: 22px !important;
    }
    
    .toc-title-link {
      color: var(--primary-color) !important;
    }
    
    .toc-title-link.active {
      font-weight: bold;
    }

    /* 추가 헤더 레벨에 대한 스타일 */
    .toc-list .toc-h4 {
      color: var(--text-light); /* h4 색상 */
      font-size: 0.85rem;
    }

    /* 목차 확장자 스타일 조정 */
    .toc-list a:not(.toc-title-link)::after {
      content: attr(data-suffix);
      opacity: 0.7;
    }

    /* 하위 목차 있는 항목 시각적 표시 */
    .toc-list-item.toc-has-children > a {
      font-weight: 500;
    }
    
    .toc-list-item.toc-has-children > a:hover {
      color: var(--primary-color);
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // 모바일 메뉴 토글
      const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
      const navMenu = document.querySelector('.nav-menu');
      
      if (mobileMenuBtn) {
        mobileMenuBtn.addEventListener('click', function() {
          navMenu.classList.toggle('active');
          const spans = mobileMenuBtn.querySelectorAll('span');
          
          if (navMenu.classList.contains('active')) {
            spans[0].style.transform = 'rotate(45deg) translate(5px, 6px)';
            spans[1].style.opacity = '0';
            spans[2].style.transform = 'rotate(-45deg) translate(5px, -6px)';
          } else {
            spans[0].style.transform = 'none';
            spans[1].style.opacity = '1';
            spans[2].style.transform = 'none';
          }
        });
      }

      // 목차(TOC) 생성 기능
      function generateTableOfContents() {
        const headings = document.querySelectorAll('.post-content h1, .post-content h2, .post-content h3, .post-content h4');
        const tocList = document.querySelector('.toc-list');
        const postTitle = document.querySelector('.post-title').textContent;
        
        if (!tocList || headings.length === 0) return;
        
        // 변경: 목차 계층 구조 - 포스트 제목을 최상위로, 모든 헤딩을 그 아래에 배치
        const tocStructure = [{
          id: 'post-title',
          text: postTitle,
          level: 'title',
          children: []
        }];
        
        // 헤딩을 분석하여 계층 구조 생성 - 수정된 알고리즘
        let currentH1 = null;
        let currentH2 = null;
        let currentH3 = null;
        
        headings.forEach((heading, index) => {
          // ID가 없으면 생성
          if (!heading.id) {
            heading.id = `heading-${index}`;
          }
          
          const level = heading.tagName.toLowerCase();
          const item = {
            id: heading.id,
            text: heading.textContent,
            level: level,
            children: []
          };
          
          // 모든 헤딩은 포스트 제목(최상위) 아래로 들어감
          if (level === 'h1') {
            // h1은 포스트 제목 바로 아래
            tocStructure[0].children.push(item);
            currentH1 = item;
            currentH2 = null;
            currentH3 = null;
          } else if (level === 'h2') {
            if (currentH1) {
              // 직전에 h1이 있으면 그 아래로
              currentH1.children.push(item);
            } else {
              // 직전에 h1이 없으면 포스트 제목 바로 아래로
              tocStructure[0].children.push(item);
            }
            currentH2 = item;
            currentH3 = null;
          } else if (level === 'h3') {
            if (currentH2) {
              // 직전에 h2가 있으면 그 아래로
              currentH2.children.push(item);
            } else if (currentH1) {
              // h2는 없고 h1만 있으면 h1 아래로
              currentH1.children.push(item);
            } else {
              // 둘 다 없으면 포스트 제목 아래로
              tocStructure[0].children.push(item);
            }
            currentH3 = item;
          } else if (level === 'h4') {
            if (currentH3) {
              // 직전에 h3가 있으면 그 아래로
              currentH3.children.push(item);
            } else if (currentH2) {
              // h3는 없고 h2만 있으면 h2 아래로
              currentH2.children.push(item);
            } else if (currentH1) {
              // h2, h3 없고 h1만 있으면 h1 아래로
              currentH1.children.push(item);
            } else {
              // 모두 없으면 포스트 제목 아래로
              tocStructure[0].children.push(item);
            }
          }
        });
        
        // 목차 HTML 생성 함수
        function createTocHTML(items, isChild = false) {
          const ul = document.createElement('ul');
          ul.className = isChild ? 'toc-children' : 'toc-list';
          
          items.forEach(item => {
            const li = document.createElement('li');
            li.className = 'toc-list-item';
            
            // 자식 요소가 있으면 클래스 추가
            if (item.children.length > 0) {
              li.classList.add('toc-has-children');
            } else {
              // 자식 요소가 없는 항목
              li.classList.add('toc-list-item-no-children');
            }
            
            // 링크 생성
            const link = document.createElement('a');
            if (item.level === 'title') {
              // 포스트 제목은 페이지 맨 위로 스크롤
              link.href = '#';
            } else {
              link.href = `#${item.id}`;
            }
            
            // 하위 목차 여부에 따라 접미사 결정
            const hasChildren = item.children.length > 0;
            const suffix = hasChildren ? '/' : '.md';
            
            // 계층에 따라 다른 앞에 표시할 텍스트와 스타일 추가
            if (item.level === 'title') {
              link.textContent = item.text;
              link.classList.add('toc-title-link');
            } else {
              link.textContent = item.text + suffix;
              link.classList.add(`toc-${item.level}`);
            }
            
            // 링크 클릭 이벤트 - 스크롤만 담당
            link.addEventListener('click', function(e) {
              e.preventDefault();
              
              if (item.level === 'title') {
                // 포스트 제목 클릭 시 페이지 맨 위로
                window.scrollTo({
                  top: 0,
                  behavior: 'smooth'
                });
              } else {
                // 해당 섹션으로 스크롤
                const targetElement = document.getElementById(item.id);
                if (targetElement) {
                  window.scrollTo({
                    top: targetElement.offsetTop - 80,
                    behavior: 'smooth'
                  });
                }
              }
              
              // 모바일에서 목차 닫기
              if (window.innerWidth <= 1024) {
                const tocSidebar = document.querySelector('.toc-sidebar');
                if (tocSidebar) {
                  tocSidebar.classList.remove('show');
                }
              }
            });
            
            // 링크 영역에 클릭 이벤트 추가해서 하위 목차 접기/펼치기
            if (item.children.length > 0) {
              li.addEventListener('click', function(e) {
                if (e.target === li || e.target === link) {
                  const childrenContainer = li.querySelector('.toc-children');
                  if (childrenContainer) {
                    childrenContainer.classList.toggle('collapsed');
                  }
                }
              });
            }
            
            li.appendChild(link);
            
            // 하위 목차 추가
            if (item.children.length > 0) {
              const childrenContainer = createTocHTML(item.children, true);
              li.appendChild(childrenContainer);
            }
            
            ul.appendChild(li);
          });
          
          return ul;
        }
        
        // 기존 목차 내용 삭제
        tocList.innerHTML = '';
        
        // 새 목차 추가
        const tocHTML = createTocHTML(tocStructure);
        
        // 제목이 하위 요소를 가지고 있을 경우에만 tocHTML의 첫 번째 자식의 모든 자식을 추가
        if (tocStructure[0].children.length > 0) {
          const titleItem = tocHTML.querySelector('.toc-list-item');
          
          if (titleItem) {
            // 제목 항목 스타일 조정
            titleItem.classList.add('toc-root-item');
            // 기존 목차에 추가
            tocList.appendChild(titleItem);
          }
        }
        
        // 스크롤 이벤트로 활성 항목 표시
        function highlightTocOnScroll() {
          const scrollPosition = window.scrollY;
          
          // 모든 헤딩 요소의 위치를 확인
          const headingPositions = Array.from(headings).map(heading => {
            return {
              id: heading.id,
              offsetTop: heading.offsetTop - 100 // 약간의 여유 공간
            };
          });
          
          // 현재 스크롤 위치에 맞는 활성 헤딩 찾기
          let activeHeadingId = '';
          for (let i = headingPositions.length - 1; i >= 0; i--) {
            if (scrollPosition >= headingPositions[i].offsetTop) {
              activeHeadingId = headingPositions[i].id;
              break;
            }
          }
          
          // 첫 번째 헤딩보다 위에 있는 경우, 타이틀을 활성화
          if (!activeHeadingId && scrollPosition < (headingPositions[0]?.offsetTop || Infinity)) {
            const titleLink = document.querySelector('.toc-title-link');
            if (titleLink) titleLink.classList.add('active');
          }
          
          // 모든 목차 링크 가져오기
          const allTocLinks = document.querySelectorAll('.toc-list a, .toc-children a');
          
          // 활성 클래스 제거 및 추가
          allTocLinks.forEach(link => {
            link.classList.remove('active');
            if (activeHeadingId && link.getAttribute('href') === `#${activeHeadingId}`) {
              link.classList.add('active');
              
              // 활성 항목이 펼쳐져 있지 않다면 부모를 자동으로 펼치기
              let parentLi = link.closest('.toc-list-item');
              while (parentLi) {
                const parentUl = parentLi.closest('.toc-children');
                if (parentUl && parentUl.classList.contains('collapsed')) {
                  // 부모 목차 펼치기
                  parentUl.classList.remove('collapsed');
                }
                parentLi = parentUl ? parentUl.closest('.toc-list-item') : null;
              }
            }
          });
          
          // 스크롤이 맨 위에 있으면 제목 활성화
          if (scrollPosition < 100) {
            const titleLink = document.querySelector('.toc-title-link');
            if (titleLink) titleLink.classList.add('active');
          }
        }
        
        // 초기 실행 및 스크롤 이벤트 등록
        highlightTocOnScroll();
        window.addEventListener('scroll', highlightTocOnScroll);
        
        // 초기 상태 설정 - 모두 펼쳐둔 상태로 시작
        function setInitialTocState() {
          // 제목 항목은 기본적으로 펼쳐둠
          const rootItem = document.querySelector('.toc-root-item');
          if (rootItem) {
            const children = rootItem.querySelector('.toc-children');
            if (children) {
              children.classList.remove('collapsed');
            }
          }
        }
        
        // 초기 상태 설정 함수 호출
        setInitialTocState();
      }
      
      // 목차 토글 버튼 - 모바일
      function setupMobileTocToggle() {
        const tocToggleBtn = document.querySelector('.mobile-toc-toggle');
        const tocSidebar = document.querySelector('.toc-sidebar');
        
        if (tocToggleBtn && tocSidebar) {
          tocToggleBtn.addEventListener('click', function() {
            tocSidebar.classList.toggle('show');
            
            // 모바일에서 목차가 표시될 때 자동으로 현재 위치의 목차 항목을 펼치기
            if (tocSidebar.classList.contains('show')) {
              const activeLink = tocSidebar.querySelector('a.active');
              if (activeLink) {
                // 스크롤하여 활성 항목이 보이도록
                activeLink.scrollIntoView({ behavior: 'smooth', block: 'center' });
              }
            }
          });
          
          // 문서 클릭 시 목차 닫기 (목차 영역 이외 클릭)
          document.addEventListener('click', function(e) {
            if (!tocSidebar.contains(e.target) && !tocToggleBtn.contains(e.target)) {
              tocSidebar.classList.remove('show');
            }
          });
        }
      }
      
      // 초기화 순서: 1) 목차 생성 2) 초기 상태 설정 3) 모바일 토글 설정
      generateTableOfContents();
      setupMobileTocToggle();
    });
  </script>
</head>

<body>
  <!-- 헤더 -->
  <header class="site-header">
    <a href="/" class="logo">NangManCat's Lab</a>
    <nav>
      <ul class="nav-menu">
        <li><a href="/">홈</a></li>
        <li><a href="https://github.com/NangManCatDev">깃허브</a></li>
        <li><a href="https://www.youtube.com/@NangManCat07">유튜브</a></li>
      </ul>
    </nav>
    <div class="mobile-menu-btn">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </header>

  <!-- 모바일 목차 토글 버튼 -->
  <button class="mobile-toc-toggle">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </button>

  <!-- 메인 컨테이너 -->
  <div class="main-container">
    <div class="post-container">
      <article class="post">
        <header class="post-header">
          <div class="post-thumbnail">
            
              <img src="/assets/thumbs/test.png" alt="test3" class="post-feature-image">
            
          </div>
          <h1 class="post-title">test3</h1>
          <div class="post-meta">
            <time datetime="2025-05-05T00:00:00+09:00" class="post-date">
              2025년 05월 05일
            </time>
            
            <span class="post-categories">
              <span class="meta-sep">•</span>
              
            </span>
            
            
          </div>
        </header>

        <div class="post-content">
          <p>test</p>

        </div>

        <footer class="post-footer">
          <div class="post-navigation">
            <div class="post-navigation-prev">
              
              <a href="/2025/05/05/test02.html" class="prev-post">
                <span class="nav-label">이전 포스트</span>
                <span class="post-title">마크다운 포맷팅 가이드</span>
              </a>
              
            </div>
            <div class="post-navigation-next">
              
              <a href="/2025/05/05/test04.html" class="next-post">
                <span class="nav-label">다음 포스트</span>
                <span class="post-title">test4</span>
              </a>
              
            </div>
          </div>

          
          <div class="related-posts">
            <h3>관련 포스트</h3>
            <ul>
              
              <li>
                <a href="/2025/05/05/test20.html">
                  <h4>test20</h4>
                  <time datetime="2025-05-05T00:00:00+09:00">2025년 05월 05일</time>
                </a>
              </li>
              
              <li>
                <a href="/2025/05/05/test19.html">
                  <h4>test19</h4>
                  <time datetime="2025-05-05T00:00:00+09:00">2025년 05월 05일</time>
                </a>
              </li>
              
              <li>
                <a href="/2025/05/05/test18.html">
                  <h4>test18</h4>
                  <time datetime="2025-05-05T00:00:00+09:00">2025년 05월 05일</time>
                </a>
              </li>
              
            </ul>
          </div>
          
        </footer>
      </article>
    </div>

    <!-- 우측 사이드바 (목차) -->
    <aside class="toc-sidebar">
      <div class="toc-container">
        <h3 class="toc-title">find . -type f | sort</h3>
        <ul class="toc-list">
          <!-- 자바스크립트로 동적 생성 -->
        </ul>
      </div>
    </aside>
  </div>

  <!-- 푸터 -->
  <footer class="site-footer">
    <div class="footer-content">
      <div class="footer-logo">Nangman's Lab</div>
      <div class="copyright">
        &copy; 2025 Nangman's Lab. All rights reserved.
      </div>
    </div>
  </footer>
</body>

</html> 